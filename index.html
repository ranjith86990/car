<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Modern Chess AI</title>

<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard.min.css"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.13.4/chess.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stockfish/stockfish.js"></script>

<style>
body{
  background: linear-gradient(135deg,#1e1e2f,#2c2c3c);
  font-family: Arial, sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  color:white;
  margin:0;
  padding:20px;
}

h1{
  margin-bottom:20px;
}

#board{
  width:90vw;
  max-width:500px;
  box-shadow:0 10px 30px rgba(0,0,0,0.6);
  border-radius:10px;
}

.controls{
  margin-top:20px;
}

button{
  padding:10px 20px;
  font-size:16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  margin:5px;
  background:#4CAF50;
  color:white;
  transition:0.3s;
}

button:hover{
  background:#45a049;
}

select{
  padding:8px;
  border-radius:6px;
}
</style>
</head>

<body>

<h1>â™Ÿ Modern Chess vs AI</h1>
<div id="board"></div>

<div class="controls">
  Difficulty:
  <select id="difficulty">
    <option value="5">Easy</option>
    <option value="10" selected>Medium</option>
    <option value="18">Hard</option>
  </select>
  <button onclick="resetGame()">New Game</button>
</div>

<script>
const game = new Chess();
const engine = STOCKFISH();

const board = Chessboard('board', {
  draggable: true,
  position: 'start',
  onDrop: onDrop,
  pieceTheme:
  'https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/img/chesspieces/wikipedia/{piece}.png'
});

function onDrop(source, target) {
  const move = game.move({
    from: source,
    to: target,
    promotion: 'q'
  });

  if (move === null) return 'snapback';

  setTimeout(makeAIMove, 300);
}

function makeAIMove() {
  const level = document.getElementById("difficulty").value;
  engine.postMessage("position fen " + game.fen());
  engine.postMessage("go depth " + level);

  engine.onmessage = function(event) {
    if (event.data.startsWith("bestmove")) {
      const move = event.data.split(" ")[1];
      game.move({
        from: move.substring(0,2),
        to: move.substring(2,4),
        promotion: 'q'
      });
      board.position(game.fen());
    }
  };
}

function resetGame(){
  game.reset();
  board.start();
}
</script>

</body>
</html>
